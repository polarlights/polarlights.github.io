<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Class - Polarlights</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="polarlights" />
  <meta name="description" content="一个类的实例可以使用类名.new来初始化，new方法会自动调用该类的initialize方法，但是由于initialize方法是类的私有方法，所以不能显式的调用它。 class Point def initialize(x, y) @x = x @y = y end end p = Point.new(2, 4) 上面的实例p并不能直接访问里面的实例变量@x,@y，因为Ruby是面向对象的语言，所以访问这些实例变量实际上是访问与实例变量的方法而已。如果直接使用p.x，Ruby会告诉你:&#34;NoMethodError" />

  <meta name="keywords" content="ruby, java, go, microservice, spring" />






<meta name="generator" content="Hugo 0.67.0" />


<link rel="canonical" href="https://polarlights.github.io/post/class-and-modules/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.fa3d941d1d0e0ddc985804227feabffea55c89883eb0af34e0532a7ae9135151.css" integrity="sha256-&#43;j2UHR0ODdyYWAQif&#43;q//qVciYg&#43;sK804FMqeukTUVE=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/prism.css">

<link rel="stylesheet" href="/css/adoc.css">

<link rel="stylesheet" href="/css/github.css">


<meta property="og:title" content="Class" />
<meta property="og:description" content="一个类的实例可以使用类名.new来初始化，new方法会自动调用该类的initialize方法，但是由于initialize方法是类的私有方法，所以不能显式的调用它。 class Point def initialize(x, y) @x = x @y = y end end p = Point.new(2, 4) 上面的实例p并不能直接访问里面的实例变量@x,@y，因为Ruby是面向对象的语言，所以访问这些实例变量实际上是访问与实例变量的方法而已。如果直接使用p.x，Ruby会告诉你:&#34;NoMethodError" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://polarlights.github.io/post/class-and-modules/" />
<meta property="article:published_time" content="2016-03-23T20:22:28+08:00" />
<meta property="article:modified_time" content="2016-03-23T20:22:28+08:00" />
<meta itemprop="name" content="Class">
<meta itemprop="description" content="一个类的实例可以使用类名.new来初始化，new方法会自动调用该类的initialize方法，但是由于initialize方法是类的私有方法，所以不能显式的调用它。 class Point def initialize(x, y) @x = x @y = y end end p = Point.new(2, 4) 上面的实例p并不能直接访问里面的实例变量@x,@y，因为Ruby是面向对象的语言，所以访问这些实例变量实际上是访问与实例变量的方法而已。如果直接使用p.x，Ruby会告诉你:&#34;NoMethodError">
<meta itemprop="datePublished" content="2016-03-23T20:22:28&#43;08:00" />
<meta itemprop="dateModified" content="2016-03-23T20:22:28&#43;08:00" />
<meta itemprop="wordCount" content="7676">



<meta itemprop="keywords" content="Ruby,Module,Class," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Class"/>
<meta name="twitter:description" content="一个类的实例可以使用类名.new来初始化，new方法会自动调用该类的initialize方法，但是由于initialize方法是类的私有方法，所以不能显式的调用它。 class Point def initialize(x, y) @x = x @y = y end end p = Point.new(2, 4) 上面的实例p并不能直接访问里面的实例变量@x,@y，因为Ruby是面向对象的语言，所以访问这些实例变量实际上是访问与实例变量的方法而已。如果直接使用p.x，Ruby会告诉你:&#34;NoMethodError"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-31475638-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



</head>

<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Polarlights</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/categories/">Categories</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
  






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Polarlights
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://polarlights.github.io/categories/">Categories</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Class</h1>
      
      <div class="post-meta">
        <time datetime="2016-03-23" class="post-time">
          2016-03-23
        </time>
        <div class="post-category">
            <a href="https://polarlights.github.io/categories/tech/"> Tech </a>
            <a href="https://polarlights.github.io/categories/ruby/"> Ruby </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      <p>一个类的实例可以使用<code>类名.new</code>来初始化，<code>new</code>方法会自动调用该类的<code>initialize</code>方法，但是由于<code>initialize</code>方法是类的私有方法，所以不能显式的调用它。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  def  initialize(x, y)
    @x = x
    @y = y
  end
end

p = Point.new(2, 4)</code></pre></div>
<p>上面的实例<code>p</code>并不能直接访问里面的实例变量@x,@y，因为Ruby是面向对象的语言，所以访问这些实例变量实际上是访问与实例变量的方法而已。如果直接使用<code>p.x</code>，Ruby会告诉你:"NoMethodError: undefined method <code>x</code> for #&lt;Point:0x007fc7c40b1ee8 @x=2, @y=4&gt;"。为了能够访问里面的实例变量，我们可以定义对应的访问方法。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  def  initialize(x, y)
    @x = x
    @y = y
  end

  def x
    @x
  end

  def x=(x)
    @x = x
  end

end

p = Point.new(2, 4)</code></pre></div>
<p>上面我们定义了Point对实例变量x的<code>getter</code>和<code>setter</code>方法，现在我们就可以正常访问x了。如果调用<code>p.x = 4</code>,那么这里实际调用的是<code>p.x=(4)</code>，即调用的为<code>x=</code>方法。</p>
<p>在Java语言中，getter和setter方法在Bean中是如此的常见，每次写都挺麻烦。那么在Ruby中有没有更好简略方法呢？有。在Ruby中有访问控制器，<code>attr_reader</code>方法定义了那些实例变量可以被外部所使用，<code>attr_accessor</code>方法定义了哪些实例变量可以被外部获取也定义了<code>setter</code>相似的功能，即它是<code>getter</code>和<code>setter</code>方法的合集。</p>
<p><strong>attr_reader和attr_accessor方法后面可以直接跟变量的名称，也可以使用Symbol，也可以使用字符串</strong></p>
<p>Ruby使用了常见的数学符号来当做方法，比如；<code>+</code>,<code>-</code>,<code>*</code>，注意，它们不是简单的符号，在Ruby中，它们其实是方法。对于减号操作<code>-</code>，有一元和二元两种形式，一元减的定义要使用<code>-@</code>，在调用的时候为<code>-对象.变量</code>。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  def  initialize(x, y)
    @x = x
    @y = y
  end

  def +(other)
    return Point.new(@x+other.x, @y+other.y)
  end

  def -@
    return Point.new(-@x,-@y)
  end

  def -(other)
    return Point.new(@x-other.x, @y-other.y)
  end

end</code></pre></div>
<p><strong>Duck Typing</strong>：它的含义是：如果它走路像一只鸭子并且也像鸭子一样嘎嘎叫，那它就是一只鸭子。</p>
<p>对于这句话怎么理解呢？以我们上面的代码为例，在定义<code>+</code>方法时，我们并没有对other作类型的校验，只要other有x,y这两个方法且返回一个数值就可以。如果把Point类当做一只鸭子，而other又像Point一样拥有x,y方法，我们不管它是否真的是Point对象，那么other就是一个"鸭子"。那么如果万一other并没有x或者y方法呢？没有就报异常咯。</p>
<p>如果我们要添加类型的检查，可以这样做：</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def +(other)
  Point.new(@x + other.x, @y + other.y)
rescue
  raise TypeError, "Point addtion is not like a Point Duck Way"
end</code></pre></div>
<p>俗语有言：条条大道通罗马。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def +(other)
  raise TypeError, "Point addtion is not like a Point Duck Way" unless
  other.respond_to? :x and other.respond_to? :y

  Point.new(@x + other.x, @y + other.y)
end

def +(other)
  raise TypeError, "Point addtion is not like a Point Duck Way" unless other.is_a? Point

  Point.new(@x + other.x, @y + other.y)
end</code></pre></div>
<p>对于Point的实例变量我们可以使用<code>[]</code>方法来访问：</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def [](index)
  case index
  when 0, -2: @x
  when 1, -1: @y
  when :x,"x": @x
  when :y,"y": @y
  else
    nil
  end
end</code></pre></div>
<p>对于Point类我们也可以定义<code>each</code>方法，来遍历实例变量。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def each
  yield @x
  yield @y
end</code></pre></div>
<p>由于Point中的实例变量是有限的，我们只需要yield两次就可以了。调用的时候是需要<code>p.each {|x| puts x}</code>即可。</p>
<p>如果类实现了each方法，那么就可以混入Enumerable模块的一些方法，这些方法都是基于each定义的，<code>include Enumerable</code>。混入了Enumerable模块，可以写出以下的代码:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">p.all? {|x| x &gt; 0} #return true if all of the elements of Point larger than zero.</code></pre></div>
<p>在Java中，如果要判断两个实例是否"相等"需要覆写<code>equals</code>方法的。那么在Ruby中如何判断两个实例是否相等呢？我们可以定义<code>==</code>方法。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def ==(other)
  if other.is_a? Point
     @x == other.x and @y == other.y
  elsif
    false
  end
end</code></pre></div>
<p>在Ruby中<code>eql?</code>也可以用来比较对象是否相等，但是它不会自动进行类型的转换，而<code>==</code>是会对类型进行自动转换的。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">puts 1 == (1.0)  #true FixNum will be converted to Float
puts 1.eql?(1.0)  #false FixNum is not the same as Float</code></pre></div>
<p>如果想让两个操作在一个类中看起来是一样的，我们可以使用前面学到的<code>alias</code>来对方法进行重命名。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">alias eql? ==</code></pre></div>
<p>如果对Point有两种比较方式，一种不严格的坐标相等，一种严格的坐标相等。那么第一种就是<code>==</code>方法了。第二种我们可以定义 <code>eal?</code>方法来实现。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def eql?(other)
  if other.instance_of? Point #sub-class instance is not allowed
     @x.eql?(other.x) and @y.eql?(other.y)  #type convert is not allowed
  elsif
    false
  end
end</code></pre></div>
<p><strong>对于Hash值的相等性判断</strong></p>
<p>Hash类的eql?使用主键进行比较，如果没有定义eql?方法，哈希表会用对象标志对对象进行比较，这意味着如果有一个哈希元素的主键是p，那么只能使用p来访问这个元素，而不能使用q,即使p==q。可变对象不适合做哈希表的主键，让eql?方法保持未定义可以绕过这个问题。</p>
<p>eql?方法用于Hash对象，不能单独定义它，类似于Java，它还需要定义如何计算它的hash值。有一个简单的方法来做到：</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def hash
  @x.hash + @y.hash
end</code></pre></div>
<p>有一个比较通用的hash生成方法，适合于大部分的Ruby类:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def hash
  code = 17
  code = 37 * code + @x.hash
  code = 37 * code + @y.hash
  #the 17 and 37 is from the "Effective Java"
  code
end</code></pre></div>
<p><strong>如何比较两个Point的大小呢？</strong></p>
<p>如果要比较两个对象的大小，一般要混入Comparable模块，实现<code>&lt;==&gt;</code>方法。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def &lt;==&gt;(other)
  return nil unless other.instance_of Point
  @x ** 2 + @y ** 2 &lt;==&gt; other.x ** 2 + other.y ** 2
end</code></pre></div>
<p>Comparable使用<code>&lt;==&gt;</code>来定义<code>==</code>方法，但是由于Point显式定义了<code>==</code>方法，所以Comparable中定义的<code>==</code>不会被调用到。</p>
<div class="quote-block"><blockquote><p>Enumerable模块定义的若干方法，比如sort, min和max等包含比较的方法只有在被枚举的对象定义了<code>&lt;==&gt;</code>才能够正常工作。</p></blockquote></div>
<p>在定义一些可变方法的时候，如果会修改原来对象的值，一般对象方法后会有<code>!</code>来标志，如果不修改原有对象，一般会返回对象的一个副本。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def add!(other)
  @x += other.x
  @y += other.y
  self
end

def add(other)
  q = self.dup
  q.add!(other)
end</code></pre></div>
<p><strong>可变类Mutable Class</strong></p>
<p>我们可以使用Struct类来定义可变的类，Struct类是Ruby的内核类，可以用于生成其它的类。在生成的类中定义的实例变量自动具有访问器方法。使用Struct来定义一个新类有两种方式:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">Struct.new("Point", :x, :y)
Point = Struct.new(:x, :y)</code></pre></div>
<div class="quote-block"><blockquote><p>在上面例子中，第二行代码使用了"命名匿名类"，如果把一个未命名的类对象赋值给一个变量的时候，这个变量名就自动称为该类的名称。上面的类就自动成为了"Point"</p></blockquote></div>
<p>使用Struct定义的新类会自动定义getter、setter、[]、[]=、each、each_pair、==、to_s方法。如果需要继续在Point类中添加新的方法，可以直接这样定义:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  def my
    puts "I am a add-handed method"
  end
end</code></pre></div>
<p>这不仅仅限于我们定义的新类，还包括任何其它的类。如果想要取消某些方法，可以使用前面学到的<code>undef</code>方法。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  undef []=, x=, y=
end</code></pre></div>
<p>BTW：所谓的可变与不变是指实例能否被外界的值所改变内部的实例变量。变与不变只是相对的，不变可以变为变的，变的可以变为不变的。</p>
<p><strong>类方法Class Method</strong></p>
<p>类方法就是传说中的单例方法，它可以单独调用，也可以使用对象.方法名来调用。定义它的方式有很多种：</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  #method one
  def Point.sum(*points)
    x, y = 0, 0
    points.each {|p| x += p.x, y += p.y}
    Point.new(x, y)
  end

  #method two
  def self.sum(*points)
    x, y = 0, 0
    points.each {|p| x += p.x, y += p.y}
    Point.new(x, y)
  end

  #method three
  class &lt;&lt; self
    def sum(*points)
      x, y = 0, 0
      points.each {|p| x += p.x, y += p.y}
      Point.new(x, y)
    end
  end

end

#method four
class &lt;&lt; Point
  def sum(*points)
    x, y = 0, 0
    points.each {|p| x += p.x, y += p.y}
    Point.new(x, y)
  end
end</code></pre></div>
<p><strong>定义类常量</strong></p>
<p>常量一般都是使用全大写的单词，常量既可以从类中定义，也可以在类外自己动态添加(oh my god, it is so powerful weapon！)</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def Point
  ORIGINAL_POINT = [0,0]
end

Point::DYNAMIC = [100, 100]</code></pre></div>
<p>要访问这些常量一般要加类的限定词，而在类内部对此没有任何要求。</p>
<p><strong>类变量 Class Variables</strong></p>
<p>类变量在不同实例之间共享，使用<code>@@</code>开头，只在内部可以引用，但是在外部是无法访问到的。类变量可以在类方法中可以被访问，类实例变量却是不可以的。</p>
<p><strong>类实例变量</strong></p>
<p>类实例变量是在类方法外定义的变量，但是这些变量是不能被实例方法所访问。不过类实例变量可能会让我们与普通的实例变量所混淆。类实例变量的优于类常量的一个重要特性是在继承现有类时，类实例变量的行为不像类变量那样让人混淆。</p>
<p>下面是分别用类变量和类实例变量写的用于统计Point的代码；</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">#class variable
class Point
  @@n = 0
  @@totalX = 0
  @@totalY = 0

  def initialize(x,y)
    @x,@y = x,y

    @@n += 1
    @@totalX += x
    @@totalY += y
  end

  def self.report
    puts "Number of points created: #@@n"
    puts "Average X coordinate: #{@@totalX.to_f / @@n}"
    puts "Average Y coordinate: #{@@totalY.to_f / @@n}"
  end
end

#class instance variable
#Because the class instance variable can't be used in the instance method, so define it in the class method
class Point
  @n = 0
  @totalX = 0
  @totalY = 0

  def initialize(x,y)
    @x,@y = x,y
  end

  def self.new(x,y)
    @n += 1
    @totalX += x
    @totalY += y

    super
  end

  def self.report
    puts "Number of points created: #@@n"
    puts "Average X coordinate: #{@@totalX.to_f / @@n}"
    puts "Average Y coordinate: #{@@totalY.to_f / @@n}"
  end
    end</code></pre></div>
<p>因为类实例变量是类对象的实例变量，我们可以使用attr_reader和attr_accessor为它们创建访问器方法。我们可以这样做:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class &lt;&lt; self
  attr_accessor :n, :totalX, :totalY
end</code></pre></div>
<section class="doc-section level-1"><h2 id="_方法的可见性">方法的可见性</h2><p>Ruby像其它大部分面向对象一样使用public、private和protected来分别表示公开、私有和受保护的。</p>
<p>在ruby中定义的方法默认为public的，但是initialize方法不是，它是私有的。在类外定义的全局方法也是被定义为类的私有方法。</p>
<p>标准的定义类的顺序是这样的；</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  #public methods
  #...

  #protected methods
  protected

  #private methods
  private

end</code></pre></div>
<p>除了常量外，Ruby的变量自动都是私有的，所以我们不能在外面直接访问它，除非有定义访问器方法设定的变量。</p>
<p>也可以在定义了方法后，在类的半部分同义定义某些方法的访问性: <code>private :x, :y</code></p>
<p>如果想要定义工厂类，那么我们一般不让直接使用<code>类.new</code>来获取新实例的，所以需要定义new的可访问性，但是由于new是类方法，所以这里需要特殊处理下，即使用<code>private_class_method</code>方法。当然如果想要将某个方法变为public的，那么可以使用<code>public_class_method</code>方法。</p></section>
<section class="doc-section level-1"><h2 id="_继承">继承</h2><p>类在继承的时候不会继承父类的实例变量，这些变量是在方法调用的时候自动生成的，这一点与Java等语言是不一样的。</p>
<p>##对象创建和初始化</p>
<p>Ruby一个new方法<strong>看起来</strong>像这样的:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby"> def new(*args)
   o = self.allocate #创建类的新对象
   o.initialize(*args) #调用对象的初始化方法，使用传入的参数进行初始化
   o  #返回对象
 end</code></pre></div>
<p>allocate是Class类的实例方法，被所有的类所继承，它的作用是创建类的一个实例。此方法不能被覆盖，因为Ruby只会调用它的原始版本，所以不会被真的覆盖掉。</p>
<p>initialize方法是一个实例方法，它的作用是为类的实例变量作初始化并赋初值。由于它是一个私有方法，所以我们不能显式地调用它。</p>
<div class="quote-block"><blockquote><p>Class类定义了两个名为new的方法，一个是Class#new，它是一个实例方法，另外一个是Class::new，它是一个类方法。Class#new用于创建一个类的新对象，而CLass::new用于创建一个新类。</p></blockquote></div>
<p>###创建一个工厂方法</p>
<p>创建工厂方法方法必须不能让外界直接使用new方法，如何做到呢？这就用到了我们上面提到的方法可见性控制的内容了。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  def initialize(x,y)
    @x,@y = x,y
  end

  private_class_method :new

  def Point.cartes(x,y)
    new(x,y)
  end

  def Point.polar(r, theta)
    new(r * Math.cos(theta), r * Math.sin(theta))
  end
end</code></pre></div>
<section class="doc-section level-2"><h3 id="_dupclone和initialize_copy">dup、clone和initialize_copy</h3><p>使用dup和clone方法也可以返回一个新对象，它分配一个调用者所属类的实例，然后把调用者的所有实例变量和修改都拷贝到新创建的对象中。clone方法比dup方法拷贝的更彻底，包括对象的单例方法和冻结状态。</p>
<p>如果类定义了一个名为initialize_copy的方法，那么clone和dup方法在拷贝完实例变量后，会执行这个方法，这个方法也是私有方法。</p>
<p>clone和dup方法把实例变量从原始对象拷贝到拷贝对象中时，它们拷贝的是引用而非实际值。也就是说，它们用的是浅拷贝，在修改拷贝对象时，它会修改被拷贝对象的值，所以一般我们在定义一个类时都要定制这两个方法的原因。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def Point
  attr_accessor :x,:y

  def initialize(x,y)
    @x,@y = x,y
  end
end

def Test
  attr_accessor :p

  def initialize(p)
    @p = p
  end
end

p = Point.new(0,0)  #x=0,y=0
t = Test.new(p)   #t.p.x=0, t.p.y=0
t1 = t.clone
t2 = t.dup   #the same as the above

t1.p.x = 1 #p.x=1, t.p.x=1, t2.p.x=1

t2.p.y = 4 #p.y = 4, t.p.y=4, t1.p.y=4

t1.p = nil #t.p = p
t2.p = nil #it have no affect on t</code></pre></div>
<p>为了防止拷贝对象，我们可以使用<code>def</code>；来删除clone和dup方法，也可以将之定义为私有的方法，暴扣new,allocate。</p></section>
<section class="doc-section level-2"><h3 id="_marshal_dump和marshal_load">marshal_dump和marshal_load</h3><p>创建对象的第三种方式是调用Marshal.load方法来重新生成前面使用Marshal.dump序列化的对象。Marshal.dump方法保存一个对象的类，并递归序列化其中每个实例变量的值。绝大多数对象都可以使用这两个方法进行存储和序列化。</p>
<p>那么什么是序列化呢？序列化是我们将对象的一些状态保存成其它形式，或变量或文件，在需要重新恢复它的状态时，我们可以从序列化的结果进行反向操作，将对象的状态恢复过来。</p>
<p>有些类要修改实现序列化的方式，这样做的原因是为对象状态提供更加紧凑的方式，不去序列化那些缓存易变的数据。修改的方法就是重新定义marshal_dump来定制序列化方式，以及marshal_load来定制反序列化的方式。marshal_load方法被一个使用allocate方法新分配但是未初始化的的对象所调用，它需要一个由marshal_dump返回的可再生的对象拷贝作为参数，然后根据参数对象的状态初始化接收者对象。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  def initialize(*coords)
    @coords = coords
  end

  def marshal_dump
    @coords.pack('w*')
  end

  def marshal_load(s)
    @coords = s.unpack('w*')
  end
end

p = Point.new(1,2,3,4)
s = p.marshal_dump
t = Point.allocate
t.marshal_load(s) #t will be the same instance variables as the instance of p</code></pre></div>
<p>下面的例子展示了如何将对象序列化到文件，并从文件反序列化对象的实例。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Logfile
  def initialize(filename)
    @filename = filename
    @io = File.open(@filename,'w')
  end

  def marshal_dump
    log "Begin marshal..."
    @filename  #just dump the filename, and leave the io object alone
  end

  def marshal_load(filename)
    @filename = filename
    @io = File.open(@filename, 'a')
    ``log "Begin ummarshal..."
  end

  def log(msg)
    @io.puts "#{Time.now}: #{msg}"
  end
end

logfile = if File.exists?('logfile')
            File.open('logfile') do |file|
              Marshal.load(file)
            end
          else
            Logfile.new('log.txt')
          end

ARGV.each do |msg|
  logfile.log msg
end

File.open('logfile', 'w') do |file|
  Marshal.dump(logfile, file)
end</code></pre></div>
<p>如果对一个类禁用了clone和dup方法，我们可能需要定制序列化方法，通过序列化和反序列化可以很容易实现对象的拷贝，我们就不可以不使用marshal_dump和marshal_load方法，让Marshal.load方法返回对象</p></section></section>
<section class="doc-section level-1"><h2 id="_单例类">单例类</h2><p>如果需要设定某个类是单例的，可以将new设置为私有，并且要阻止dup和clone方法不返回新的拷贝。也可以包含<code>singleton</code>模块，并在类中include Singleton就可以。这样会定义一个名为instance的方法来返回该类的一个实例。不过需要注意的是，这样定义的类是不能使用带参数的initialize方法。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">require "singleton"

class PointStats
  include Singleton

  def initialize
    @n, @totalX, @totalY = 0, 0, 0
  end

  def record(point)
    @n +=1
    @totalX += point.x
    @totalY += point.y
  end

  def report
    puts "Number of points are: #@n"
  end
end</code></pre></div>
<p>在Point类中可以这样定义initialize方法:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">def initialize(x,y)
  @x,@y = x,y
  PointStats.instance.record(self)
end</code></pre></div>
<p>想要获取返回的值，可以这样做:</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">PointStats.instance.report</code></pre></div></section>
<section class="doc-section level-1"><h2 id="_模块modules">模块Modules</h2><p>模块与类是很相似的，是方法、常量和变量的命名组，它使用关键字<code>module</code>。与类不同的地方是模块不能被实例化，也不能被继承，只能作为命名空间和混入(Mixin)使用。</p>
<section class="doc-section level-2"><h3 id="_模块用于命名空间">模块用于命名空间</h3><p>一个模块内部是可以相互嵌套的，这样会产生嵌套的命名空间。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">module  Base64
  DIGITS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'

  class Encoder
    def encoder
    end
  end

  class Decode
    def decoder
    end
  end

  def Base.help #or self.help
  end
end</code></pre></div>
<p>在外部使用常量需要Base64::DIGITS，使用某个方法可以使用Base64.help, encoder = Base64::Encoder.new</p>
<p>##Module用于混入</p>
<p>模块的第二个作用是用于混入，Enumerable和Comparable是两个比较常见的模块，前者在混入的类中，如果定义了each方法，那么这个类就会有很多强大的迭代器,如each_with_index,each_with_object。如果Comparable模块被混入，且类定义了<code>&lt;==&gt;</code>方法，那么这个类的&gt;、&lt;、=方法就会自动拥有。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">class Point
  include Comparable
end</code></pre></div>
<p>上面的include看起来是一个关键字，但实际上它是Module类的一个私有方法,隐式地被self调用。<code>self.include(Comparable)</code>。但是在代码中这样书写是错误的，它必须以函数的形式被调用。include方法可以接受多个Module对象进行混入，所以如果一个类定义了each和&lt;==&gt;方法的类可以加入<code>include Enumerable, Comparable</code>。</p>
<p>虽然class也是模块，但是类不允许include在另一个类中，include的参数必须是以module进行声明的模块。但是将模块包含在另一个模块中是合法的。</p>
<div class="listing-block"><pre>module Iterable
  include Enumerable

  def each
    loop { yield self.next }
  end
end</pre></div>
<p>混入一个模块的方式除了使用include外，还可以使用Object.extend方法，它可以将指定模块的实例方法变成接收对象的单键方法。</p>
<div class="listing-block"><pre>countdown = Object.new
def countdown.each
  yield 1
  yield 3
  yield 2
end

countdown.extend(Enumerable) #now the each method becomes a singleton method of Object and have the mothods in Enumerable
print countdown.sort</pre></div></section>
<section class="doc-section level-2"><h3 id="_可包含的命名空间模块">可包含的命名空间模块</h3><p>前面我们定义的module中的方法都是以混入类的实例方法来调用的，我们可以将混入的方法以类的私有方法来进行调用。在就爱那个方法定义为了实例方法之后，使用<code>module_function</code>将这些方法定义为"`模块函数`"。module_function与public、private等类似，它的主要作用是对给定方法创建类方法的拷贝和将实例方法变为私有的。module_function可以不跟参数，类似与private、public这样的效果，所以如果不想让某些方法成为非模块函数时需要将它定义在module_function的前面。</p>
<p>使用module_function不是出于访问控制的需要，真实目的是让这些方法必须用无接受者的函数风格的调用方式。强制被包含模块的方法以无接收者的方式调用，减少了与真正的实例方法混淆的可能。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">module My
  def test
    puts "hello world"
  end

  module_function :test
end

class Point
  def my
    test
  end
end

p = Point.new
p.test #Wrong
p.my #hello world
My.test #hello world</code></pre></div></section>
<section class="doc-section level-2"><h3 id="_加载和请求模块">加载和请求模块</h3><p>Ruby程序被分散在多个文件的时候，我们需要将它们"`组装`"起来，组装的方法就是<code>require</code>和 <code>load</code>。require和load的作用类似，但是require更加常用，require还可以用于从标准库中加载文件。require还可以加载二进制扩展，如so和dll。load方法要求加载的为包含文件扩展名的完整文件名称，而require只需要传入文件的名字，而不需要后缀。如果一个目录下同时拥有同名的不同后缀的文件，那么require优先加载文件格式的文件，而不是二进制文件。load方法会加载一个路径多次，而require由于会将文件路径展开，所以不会重复，且它把已经加载过的文件名方在全局数组<code>$"</code>中。</p>
<p>Ruby的加载路径可以使用<code>$LOAD_PATH</code>或<code>$:</code>来获取。越是靠前的路径优先被搜索。在ruby 1.9中，load_path数组的元素可以是字符串，也可以是任何实现了<code>to_path</code>的类对象。</p></section>
<section class="doc-section level-2"><h3 id="_执行加载的代码">执行加载的代码</h3><p>load和require会立刻执行制定文件的代码，但是这种执行方式与直接调用文件中的代码并不是等价的。</p>
<p>用load和require加载的文件在顶级范围中被执行，而不是在load或require被调用的层级中执行。被夹在的文件可以访问那些加载时已定义的所有全局变量和常量，但是实例变量是不能在文件外被访问到。另外self的值永远是主对象，load和require不会把接收者对象传递给所加载的文件。</p>
<p>load方法在调用时，如果第二个参数值不是nil或false，它会wrap给定的文件到一个匿名模块中，这意味着加载的文件不会影响全局命名空间，它命名的所有常量被放入到这个匿名模块中。这种包裹加载方式作为一种安全措施而存在。</p>
<p>当一个文件被加载到匿名模块中，它亦然可以设置全局变量，而且这些变量也可被加载的代码所使用。</p></section>
<section class="doc-section level-2"><h3 id="_autoloading_modules">autoloading Modules</h3><p>Kernel和Module的autoload方法支持按需惰性加载的机制，它允许使用一个未定义的常量和定义了该常量的包名。在这个常量在第一次被引用的时候，那个注册的包就使用require进行加载。</p>
<div class="listing-block"><pre class="highlight"><code class="language-ruby" data-lang="ruby">auload :TCPSocket, "socket"</code></pre></div>
<p>使用autoload?或Module.autoload?方法可以测试一个常量是否加载一个文件，它们带有一个符号参数。如果这个符号参数加载了一个文件，autoload?方法返回文件名，否则返回nil。</p></section></section>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">polarlights</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
      2016-03-23
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://polarlights.github.io/tags/ruby/">Ruby</a>
          <a href="https://polarlights.github.io/tags/module/">Module</a>
          <a href="https://polarlights.github.io/tags/class/">Class</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/how-to-test-a-class/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">how_to_test_class_and_module</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/how_minitest_works_part_2/">
            <span class="next-text nav-default">How Minitest Works Part 2</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    Show Disqus Comments
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "https://polarlights.github.io/post/class-and-modules/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'PolarLights';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:godhuyang@hotmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/polarlights" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://polarlights.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2012 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        polarlights
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  














  <script src="/js/prism.js"></script>

  <script src="/js/fix-adoc.js"></script>


</body>

</html>